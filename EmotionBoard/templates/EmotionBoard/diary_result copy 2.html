{% extends "EmotionBoard/board_base.html" %}
{% load static %}
{% block title %} Write {% endblock %}


{% block content %}
<!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css"> -->
<style>
    #chart_wrapper {
        text-align: center;
    }
    .col-6 {
        margin-left: auto;
        margin-right: auto;
    }
</style>
    <div class="main_wrap">
        <form name="write_diary_input" action="" method="POST"  enctype="multipart/form-data">
            <div>
                <div class="title_input clearfix" style="text-align: center; margin-top: 30px;" >
                    <label for="inp" class="inp">
                        {%if diary_title%}
                        <input type="title" name="title" id="inp" placeholder="&nbsp;" style="font-size: 25px;" value="{{diary_title}}" readonly>
                        {%else%}
                        <input type="title" name="title" id="inp" placeholder="&nbsp;" style="font-size: 25px;">
                        {%endif%}
                        <span class="label" style="font-size: 20px;">일기 제목</span>
                        <span class="border"></span>
                      </label>

                    
                </div>
                <div class="write_diary_image_input" id = 'image_input' style="margin: auto; margin-top: 30px;" >
                    <img src="{{diary_img.url}}" style="width:98%; height:94%; image-rendering: -webkit-optimize-contrast;">
                </div>
                <div style="text-align: center; margin-top: 40px;">
                    {% csrf_token %}
                    
                    <textarea placeholder="일기 내용" id="text" name="content"
                        style="height: 250px; width: 80%; overflow: visible;" onkeydown="resize(this)" readonly>{{diary_content}}
                    </textarea>
                </div>
            </div>
            <div>
                <div style="text-align: center;" class="mt-4">
                    <h1>오늘의 감정</h1>
                </div>
            </div>

                <!-- Content Row -->
                <div class="container">
                    <div id="chart_wrapper">
                        <div>
                            <div class="card shadow mb-4">
                                <!-- Card Body -->
                                <div class="card-body">
                                    <div class='col'>
                                        <canvas id="myChart" style="width: 400px; height: 400px;"></canvas>
                                    </div>
                        
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            <div style="text-align: center;" class="mt-4">
                <h2>오늘은 {{emotion}} 감정을 느끼시군요!</h2>
            </div>

            <body class = "body">
                <div class="swiper-container swiper" style="padding-right: 20px; padding-left: 20px;">
                    <div class="slide-content" style="margin-bottom: 30px;">
                        <h4 class="mt-4 ml-2" style="position: absolute;" >오늘은 이런 플레이리스트 어때요??</h4>
                        <a onClick="window.location.reload()" class="mt-4" style="cursor: pointer; position: absolute; right: 1%">
                            <img src="{%static 'css/images/layout/reload.png'%}" alt="">
                            </a>
                        <!-- <h4 class="mt-4" style="position: absolute; right: 1%;">새로고침</h4> -->
                        <div class="card-wrapper swiper-wrapper">
                            {%for index in youtube_list%}
                            <div class="card swiper-slide">
                                <div class="image-content">
                                    <span class="overlay"></span>
                                    
                                    <div class="card-image">
                                        <img class="card-img" src="{{index.thumnail}}" alt="" style="width: 150px; height: 150px;">
                                    </div>
                                </div>

                                <div class="card-content">
                                    <h4 class="name" >{{index.title|truncatechars:30}}</h4>
                                    <!-- <p class="description">으아아아아</p> -->

                                </div>
                            </div>
                            {%endfor%}
                        </div>
                    </div>
                    <!-- <div class="swiper-button-next2" style="padding-left: 50px;"></div>
                    <div class="swiper-button-prev2" style="padding-right: 50px;"></div> -->
                </div>
            </body>

            <div class="bsde" style="margin: 0; text-align: center;">
                <div style="text-align: center; display: inline-block;">
                    <div style="border: 1px solid #000; border-radius: 4px;">
                        <div class="card-header1" style="background-color: rgb(228, 228, 228);">
                            <h5 class="m-0 font-weight-bold text-primary">오늘의 추천 장르는
                                 [
                                 {%for genre in movie_genre_list%}
                                 {%if forloop.last%}
                                 {{genre}}
                                 {%else%}
                                {{genre}}, 
                                {%endif%}
                                 {%endfor%}
                                 ]
                                 입니다</h5>
                        </div>
                    </div>
                </div>
                
                <h5 style="margin-top: 30px;">보고 싶은 장르를 선택하세요(최대 3개)</h5>
                
                <div class="write_diary_image_input1" id = 'image_input' style="margin: auto; margin-top: 10px;" >
                    <div class="form-check" style="margin-top: 35px;">

                        {%for genre in genre_list%}
                            <input class="form-check-input" type="checkbox" name = "selected" id="check{{forloop.counter0}}" value = "{{genre}}">
                            <label class="form-check-label" for="check{{forloop.counter0}}"><span style="font-size: 25px;">{{genre}}</span></label>
                            {%if forloop.counter0 == 4%}
                            <br>
                            {%endif%}
                        {%endfor%}

                    </div>
                </div>
                <input type="submit" name = "movie_drama_recommend" value="추천해주세요" style="width: 150px; height: 50px; margin-top: 30px; font-size: 20px;">
                </button>
            </div>
            <body class = "body1" >
                
                <div class="swiper-container swiper" style="padding-right: 20px; padding-left: 20px;">
                    <div class="slide-content" style="margin-bottom: 30px;">
                        <h4 class="mt-4 ml-2" style="position: absolute;" >오늘은 이런 영화/드라마 어때요??</h4>
                        <a onClick="window.location.reload()" class="mt-4" style="cursor: pointer; position: absolute; right: 1%">
                            <img src="{%static 'css/images/layout/reload.png'%}" alt="">
                            </a>
                        <div class="card-wrapper swiper-wrapper">
                            {%if recomment_list%}
                                {%for recomment in recomment_list%}
                                {%for index in recomment%}
                                    <div class="card swiper-slide">
                                        <div class="image-content">
                                            <span class="overlay"></span>
                                            
                                            <div class="card-image">
                                                <img class="card-img" src="{{index.thumnail}}" alt="" style="width: 150px; height: 150px;">
                                            </div>
                                        </div>
        
                                        <div class="card-content">
                                            <h2 class="name">{{index.title}}</h2>
                                            <p class="description">{{index.released_date}}</p>
        
        
                                        </div>
                                    </div>
                                {%endfor%}
                                {%endfor%}
                            {%endif%}
                        </div>
                    </div>
                    <!-- <div class="swiper-button-next2" style="padding-left: 50px;"></div>
                    <div class="swiper-button-prev2" style="padding-right: 50px;"></div> -->
                </div>
            </body>
            <input type="submit" value="최종 저장 ㄱㄱ" name="final_save" class="diary_submit_button" style="margin-bottom: 20px;">
        </form>
    </div>

{% endblock %}

{% block script %}

<!-- <script src="https://cdn.jsdelivr.net/npm/chart.js"></script> -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.8.0/chart.min.js" ></script>
                                    <script>
                                        const ctx = document.getElementById('myChart');
                                        new Chart(ctx, {
                                            type: 'bar',
                                            data: {
                                              labels: ['Red', 'Blue', 'Yellow', 'Green', 'Purple', 'Orange'],
                                              datasets: [{
                                                label: '# of Votes',
                                                data: [12, 19, 3, 5, 2, 3],
                                                borderWidth: 1
                                              }]
                                            },
                                            options: {
                                              scales: {
                                                y: {
                                                  beginAtZero: true
                                                }
                                              }
                                            }
                                          });
                                    </script>

<script src="//code.jquery.com/jquery.min.js"></script>
<!-- <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>  -->
<!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js"></script>  -->
<!-- Swiper JS -->
<script src="{%static 'js/swiper-bundle.min.js'%}"></script>
<script type="text/javascript">
   

    function setThumbnail(event) {
        
        const reader = new FileReader();

        reader.onload = function(event) {
          var img = document.createElement("img");
          img.setAttribute("src", event.target.result);
          img.setAttribute("style","width:750px; height:330px; image-rendering: -webkit-optimize-contrast;")
          img.setAttribute("name","diary_img")
          document.getElementById("image_input").firstChild.remove()
          document.getElementById("image_input").appendChild(img);
        };
        reader.readAsDataURL(event.target.files[0]);
    }

    $(document).ready(function(){
        $("input[type='checkbox']").on("click",function(){
            let count = $("input:checked[type='checkbox']").length;

            if (count>3){
                //$(this).prop("checked",false);
                this.checked=false;
                alert("3개까지만 선택이 가능합니다.")
            }
        });
    });
      
    var checkbox_list = document.querySelectorAll(".form-check-input")
    for(let i=0; i<checkbox_list.length; i++){
        //console.log(checkbox_list[i].value)
        //console.log({{selected_list|safe}}.indexOf(checkbox_list[i].value))
        if({{selected_list|safe}}.indexOf(checkbox_list[i].value)>-1){
            checkbox_list[i].checked=true
        }
    }
    console.log({{selected_list|safe}})
    //console.log({{selected_list}}.contains(checkbox_list[i].value))

      /*
      $("textarea.autosize").on('keydown keyup', function () {
        $(this).height(1).height( $(this).prop('scrollHeight')+12 );	
      });
      */
</script>
<link rel="stylesheet" type="text/css" href="{% static 'css/event_style.css' %}">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/4.5.1/css/swiper.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="{%static 'js/scrits.js'%}"></script>
<!-- <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/all.css" integrity="sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ" crossorigin="anonymous"> -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

{% endblock %}